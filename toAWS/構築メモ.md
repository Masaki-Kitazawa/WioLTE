# AWS IoT コア

## ポリシーの作成

安全性＞ポリシー＞作成

|項目|設定値|
|---|---|
|名前|任意（wioltePolicyとした）|
|アクション|iot:*|
|リソースARN|*|
|効果|許可にチェック|

アクションで許可する操作を制御できるが、全部OKの*にする。

リソースARNは、どのデバイスに対する許可が制御できるが、全部OKの*とする。


## モノ(Thing)の作成

管理＞モノ＞作成＞単一のモノを作成する

|項目|設定値|
|---|---|
|名前|任意（wiolteThingとした）|

名前のみ入力し、「次へ」

「証明書の作成」をクリック

作成された証明書をダウンロード（リンクをクリック）
- このモノの証明書（xxxx-certificate.pem.crt）
- プライベートキー（xxxx-private.pem.key）
- AWS IoT のルートCAダウンロード ＞リンク先にある「Amazon ルート CA 1」等を使用


「有効化」をクリック

「ポリシーをアタッチ」をクリック

先に作ったポリシーを選択し「モノの登録」をクリック


### カスタムエンドポイントの確認

左下の「設定」をクリックで表示される


### 証明書の再作成

管理＞モノ＞該当のモノ(Thing)を選択＞セキュリティ＞証明書の作成

再作成したら、再度ダウンロードおよひ有効化が必要


# SORACOM

## SIMグループ作成

SIMグループを作成

|項目|設定値|
|---|---|
|名称|任意（wiolte2awsとした）|

SORACOM BEAM設定＞＋をクリックして「MQTTエントリポイント」を新規作成

|項目|設定値|
|---|---|
|設定名|任意（wiolteMQTTとした）|
|種別|Other MQTT Broker|
|プロトコル|MQTTS|
|ホスト名|AWS IoT Coreのカスタムエンドポイント|
|ポート番号|8883|
|ユーザ名|空欄|
|パスワード|空欄|
|証明書|ON|
|認証情報|＋をクリックして作成（内容は下記）|
|IMSI付与|ON|

## 認証情報

|項目|設定値|
|---|---|
|認証情報ID|任意（wiolteCertとした）|
|概要|任意|
|種別|X.509証明書|
|秘密鍵(key)|AWS IoT Coreで用意したプライベートキー（xxxx-private.pem.key）|
|証明書(cert)|AWS IoT Coreで用意したモノの証明書（xxxx-certificate.pem.crt）|
|CA証明局|「Amazon ルート CA 1」等|


